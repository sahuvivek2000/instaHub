"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativePaper=require("react-native-paper");var _native=require("@react-navigation/native");var _reactNativeEncryptedStorage=_interopRequireDefault(require("react-native-encrypted-storage"));var _materialTopTabs=require("@react-navigation/material-top-tabs");var _reactNativeAxios=_interopRequireDefault(require("react-native-axios"));var _ProfileHead=_interopRequireDefault(require("./ProfileHead"));var _StoryTab=_interopRequireDefault(require("./StoryTab"));var _PostGrid=_interopRequireDefault(require("./PostGrid"));var _app_constants=_interopRequireDefault(require("./app_constants"));var _EditProfile=_interopRequireDefault(require("./modal/EditProfile"));var _this=void 0,_jsxFileName="/home/demonic/Desktop/instaHub/Profile.js";var userDetail;var userList;var userData;var height=_reactNative.Dimensions.get('screen').height;var width=_reactNative.Dimensions.get('screen').width;var Tab=(0,_materialTopTabs.createMaterialTopTabNavigator)();var Profile=function Profile(props){var _useState=(0,_react.useState)(true),_useState2=(0,_slicedToArray2["default"])(_useState,2),expanded=_useState2[0],setExpanded=_useState2[1];var _useState3=(0,_react.useState)(false),_useState4=(0,_slicedToArray2["default"])(_useState3,2),storyHighlight=_useState4[0],setStoryHighlight=_useState4[1];var _useState5=(0,_react.useState)(true),_useState6=(0,_slicedToArray2["default"])(_useState5,2),postGrid=_useState6[0],setPostGrid=_useState6[1];var _useState7=(0,_react.useState)(false),_useState8=(0,_slicedToArray2["default"])(_useState7,2),tagPostGrid=_useState8[0],setTagPostGrid=_useState8[1];var _useState9=(0,_react.useState)(true),_useState10=(0,_slicedToArray2["default"])(_useState9,2),isLogin=_useState10[0],setIsLogin=_useState10[1];var _useState11=(0,_react.useState)(),_useState12=(0,_slicedToArray2["default"])(_useState11,2),user=_useState12[0],setUser=_useState12[1];var _useState13=(0,_react.useState)(false),_useState14=(0,_slicedToArray2["default"])(_useState13,2),showLoader=_useState14[0],setShowLoader=_useState14[1];var _useState15=(0,_react.useState)(),_useState16=(0,_slicedToArray2["default"])(_useState15,2),userDetailFull=_useState16[0],setUserDetailFull=_useState16[1];var _useState17=(0,_react.useState)(false),_useState18=(0,_slicedToArray2["default"])(_useState17,2),isEditProfile=_useState18[0],setIsEditProfile=_useState18[1];(0,_react.useEffect)(function(){var getData=function getData(){var data;return _regenerator["default"].async(function getData$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regenerator["default"].awrap(_reactNativeEncryptedStorage["default"].getItem('user_session'));case 3:data=_context.sent;data=JSON.parse(data);userData=data;setUser(data);_context.next=9;return _regenerator["default"].awrap(fetchUser());case 9:_context.next=11;return _regenerator["default"].awrap(checkUser());case 11:_context.next=16;break;case 13:_context.prev=13;_context.t0=_context["catch"](0);console.log(_context.t0);case 16:case"end":return _context.stop();}}},null,null,[[0,13]]);};getData();},[]);(0,_native.useFocusEffect)(_react["default"].useCallback(function(){var getData=function getData(){var data;return _regenerator["default"].async(function getData$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regenerator["default"].awrap(_reactNativeEncryptedStorage["default"].getItem('user_session'));case 3:data=_context2.sent;data=JSON.parse(data);userData=data;console.log('useFocus');_context2.next=9;return _regenerator["default"].awrap(checkUser());case 9:_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2["catch"](0);console.log(_context2.t0);case 14:case"end":return _context2.stop();}}},null,null,[[0,11]]);};getData();},[]));var fetchUser=function fetchUser(){var users,res;return _regenerator["default"].async(function fetchUser$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setShowLoader(true);_context3.prev=1;_context3.next=4;return _regenerator["default"].awrap(_reactNativeAxios["default"].get("".concat(_app_constants["default"],"/users/")));case 4:users=_context3.sent;console.log('fetchUser',users.data);userList=users.data;res=users.data.filter(function(i){return i._id===userData.userId;});console.log('res',res);setUser(res[0]);_context3.next=15;break;case 12:_context3.prev=12;_context3.t0=_context3["catch"](1);console.log(_context3.t0);case 15:setShowLoader(false);case 16:case"end":return _context3.stop();}}},null,null,[[1,12]]);};var checkUser=function checkUser(){var result;return _regenerator["default"].async(function checkUser$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setShowLoader(true);console.log('first');_context4.next=4;return _regenerator["default"].awrap(_reactNativeAxios["default"].get("".concat(_app_constants["default"],"/userDetail/").concat(userData.userId)));case 4:result=_context4.sent;console.log('checkUser',result.data);userDetail=result.data;setUserDetailFull(result.data);setShowLoader(false);case 9:case"end":return _context4.stop();}}});};var handlePress=function handlePress(){return setExpanded(!expanded);};var parentFunction=function parentFunction(data){setIsLogin(data);props.childFunction(data);console.log('profile',data);};var editProfileCallback=function editProfileCallback(value){setIsEditProfile(value);};return _react["default"].createElement(_reactNative.View,{style:styles.profile,__self:_this,__source:{fileName:_jsxFileName,lineNumber:135,columnNumber:5}},showLoader&&_react["default"].createElement(_reactNative.View,{style:styles.loader,__self:_this,__source:{fileName:_jsxFileName,lineNumber:137,columnNumber:9}},_react["default"].createElement(_reactNative.ActivityIndicator,{size:70,color:"#fff",__self:_this,__source:{fileName:_jsxFileName,lineNumber:138,columnNumber:11}})),user&&user.username&&_react["default"].createElement(_ProfileHead["default"],{childFunction:parentFunction,userName:user.username,__self:_this,__source:{fileName:_jsxFileName,lineNumber:142,columnNumber:9}}),_react["default"].createElement(_reactNative.View,{style:styles.profileUser,__self:_this,__source:{fileName:_jsxFileName,lineNumber:144,columnNumber:7}},_react["default"].createElement(_reactNative.View,{style:{justifyContent:'center'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:145,columnNumber:9}},_react["default"].createElement(_reactNativePaper.Avatar.Image,{size:85,color:"white",source:require('./assests/avatar-icon.jpg'),style:{backgroundColor:'blue'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:146,columnNumber:11}})),_react["default"].createElement(_reactNative.View,{style:{flexDirection:'row',alignItems:'center',width:_reactNative.Dimensions.get('screen').width*70/100,justifyContent:'space-around'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:154,columnNumber:9}},_react["default"].createElement(_reactNative.View,{style:{alignItems:'center'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:165,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:166,columnNumber:13}},"0"),_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:167,columnNumber:13}},"Posts")),_react["default"].createElement(_reactNative.View,{style:{alignItems:'center'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:169,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:170,columnNumber:13}},userDetail&&userDetail[0].follower&&userDetail[0].follower.length),_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:175,columnNumber:13}},"Followers")),_react["default"].createElement(_reactNative.View,{style:{alignItems:'center'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:177,columnNumber:11}},_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:178,columnNumber:13}},' ',userDetail&&userDetail[0].following.length),_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:182,columnNumber:13}},"Following")))),userData&&_react["default"].createElement(_reactNative.View,{style:{left:17},__self:_this,__source:{fileName:_jsxFileName,lineNumber:187,columnNumber:9}},_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:188,columnNumber:11}},user&&user.username),_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:191,columnNumber:11}},"Bio")),_react["default"].createElement(_reactNative.View,{style:{marginTop:10,flexDirection:'row',justifyContent:'space-evenly'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:194,columnNumber:7}},_react["default"].createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){return setIsEditProfile(true);},style:{borderColor:'#505050',borderWidth:1.3,borderRadius:5,width:width*84/100,height:height*4/100,display:'flex',justifyContent:'center',alignItems:'center'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:201,columnNumber:9}},_react["default"].createElement(_reactNative.Text,{style:{color:'white',fontSize:15},__self:_this,__source:{fileName:_jsxFileName,lineNumber:213,columnNumber:11}},"Edit Profile")),_react["default"].createElement(_reactNative.TouchableOpacity,{style:{borderColor:'#505050',borderWidth:1.3,borderRadius:5,width:width*9/100,height:height*4/100,display:'flex',justifyContent:'center',alignItems:'center'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:215,columnNumber:9}},_react["default"].createElement(_reactNativePaper.IconButton,{icon:"chevron-down",color:"white",__self:_this,__source:{fileName:_jsxFileName,lineNumber:226,columnNumber:11}}))),_react["default"].createElement(_reactNative.View,{style:styles.storyHighlight,__self:_this,__source:{fileName:_jsxFileName,lineNumber:229,columnNumber:7}}),_react["default"].createElement(_reactNative.View,{style:styles.postGrid,__self:_this,__source:{fileName:_jsxFileName,lineNumber:305,columnNumber:7}},_react["default"].createElement(_reactNative.View,{style:{flexDirection:'row',justifyContent:'space-around',borderBottomColor:'#202020',borderBottomWidth:1},__self:_this,__source:{fileName:_jsxFileName,lineNumber:306,columnNumber:9}},_react["default"].createElement(_reactNative.TouchableOpacity,{style:[postGrid?{borderBottomColor:'white',borderBottomWidth:1,width:'50%',alignItems:'center'}:{width:'50%',alignItems:'center'}],onPress:function onPress(){return setPostGrid(true),setTagPostGrid(false);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:313,columnNumber:11}},_react["default"].createElement(_reactNativePaper.IconButton,{icon:"grid",color:"white",__self:_this,__source:{fileName:_jsxFileName,lineNumber:325,columnNumber:13}})),_react["default"].createElement(_reactNative.TouchableOpacity,{style:[tagPostGrid?{borderBottomColor:'white',borderBottomWidth:1,width:'50%',alignItems:'center'}:{width:'50%',alignItems:'center'}],onPress:function onPress(){return setPostGrid(false),setTagPostGrid(true);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:327,columnNumber:11}},_react["default"].createElement(_reactNativePaper.IconButton,{icon:"account-box-outline",color:"white",__self:_this,__source:{fileName:_jsxFileName,lineNumber:339,columnNumber:13}}))),_react["default"].createElement(_PostGrid["default"],{userId:userData,__self:_this,__source:{fileName:_jsxFileName,lineNumber:342,columnNumber:9}})),_react["default"].createElement(_EditProfile["default"],{open:isEditProfile,modalClose:editProfileCallback,__self:_this,__source:{fileName:_jsxFileName,lineNumber:344,columnNumber:7}}));};var styles=_reactNative.StyleSheet.create({profile:{width:'100%',height:_reactNative.Dimensions.get('screen').height*90/100,backgroundColor:'black'},profileUser:{height:_reactNative.Dimensions.get('screen').height*13/100,flexDirection:'row',justifyContent:'space-around'},storyHighlight:{},postGrid:{height:'60%',top:30,flex:0.89},loader:{position:'absolute',zIndex:2,height:height,width:width,backgroundColor:'rgba(0,0,0,0.8)',alignItems:'center',justifyContent:'center'}});var _default=Profile;exports["default"]=_default;